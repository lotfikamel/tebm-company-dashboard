import{r as j,R as c,P as a,H as d,t as u,p as P,j as s,m,w as v,e as _,c as C,n as L,l as h}from"./index-8aeefa04.js";import{u as p}from"./useMutation-1dcb797a.js";import{u as N}from"./usePermissions-f0efe441.js";import{M as $}from"./more-vertical-515829e2.js";import{E as T}from"./external-link-51b68c72.js";function g(){return g=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},g.apply(this,arguments)}function A(e,n){if(e==null)return{};var t=S(e,n),r,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)r=i[o],!(n.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(t[r]=e[r])}return t}function S(e,n){if(e==null)return{};var t={},r=Object.keys(e),o,i;for(i=0;i<r.length;i++)o=r[i],!(n.indexOf(o)>=0)&&(t[o]=e[o]);return t}var y=j.forwardRef(function(e,n){var t=e.color,r=t===void 0?"currentColor":t,o=e.size,i=o===void 0?24:o,l=A(e,["color","size"]);return c.createElement("svg",g({ref:n,xmlns:"http://www.w3.org/2000/svg",width:i,height:i,viewBox:"0 0 24 24",fill:"none",stroke:r,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},l),c.createElement("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),c.createElement("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"}))});y.propTypes={color:a.string,size:a.oneOfType([a.string,a.number])};y.displayName="Lock";const M=y;function b(){return b=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},b.apply(this,arguments)}function R(e,n){if(e==null)return{};var t=U(e,n),r,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)r=i[o],!(n.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(t[r]=e[r])}return t}function U(e,n){if(e==null)return{};var t={},r=Object.keys(e),o,i;for(i=0;i<r.length;i++)o=r[i],!(n.indexOf(o)>=0)&&(t[o]=e[o]);return t}var k=j.forwardRef(function(e,n){var t=e.color,r=t===void 0?"currentColor":t,o=e.size,i=o===void 0?24:o,l=R(e,["color","size"]);return c.createElement("svg",b({ref:n,xmlns:"http://www.w3.org/2000/svg",width:i,height:i,viewBox:"0 0 24 24",fill:"none",stroke:r,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},l),c.createElement("polyline",{points:"3 6 5 6 21 6"}),c.createElement("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),c.createElement("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),c.createElement("line",{x1:"14",y1:"11",x2:"14",y2:"17"}))});k.propTypes={color:a.string,size:a.oneOfType([a.string,a.number])};k.displayName="Trash2";const W=k;function x(){return x=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},x.apply(this,arguments)}function B(e,n){if(e==null)return{};var t=V(e,n),r,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)r=i[o],!(n.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(t[r]=e[r])}return t}function V(e,n){if(e==null)return{};var t={},r=Object.keys(e),o,i;for(i=0;i<r.length;i++)o=r[i],!(n.indexOf(o)>=0)&&(t[o]=e[o]);return t}var w=j.forwardRef(function(e,n){var t=e.color,r=t===void 0?"currentColor":t,o=e.size,i=o===void 0?24:o,l=B(e,["color","size"]);return c.createElement("svg",x({ref:n,xmlns:"http://www.w3.org/2000/svg",width:i,height:i,viewBox:"0 0 24 24",fill:"none",stroke:r,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},l),c.createElement("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),c.createElement("path",{d:"M7 11V7a5 5 0 0 1 9.9-1"}))});w.propTypes={color:a.string,size:a.oneOfType([a.string,a.number])};w.displayName="Unlock";const q=w,f={blockDriver:"/actions/drivers/block",unblockDriver:"/actions/drivers/unblock",attachEngine:"/actions/drivers/attach-engine",detachEngine:"/actions/drivers/detach-engine"};function Q({driverId:e}){return new Promise((n,t)=>{d.post(f.blockDriver,{driverId:e}).then(()=>n()).catch(r=>{var o;return(o=r.response)!=null&&o.data&&u({message:"vous ne pouvez pas bloqué ce chauffeur."}),t(r)})})}function H({driverId:e}){return new Promise((n,t)=>{d.post(f.unblockDriver,{driverId:e}).then(()=>n()).catch(r=>t(r))})}function K({driverId:e,engineId:n}){return new Promise((t,r)=>{d.post(f.attachEngine,{driverId:e,engineId:n}).then(()=>t()).catch(o=>{var i;return(i=o.response)!=null&&i.data&&u({message:"vous ne pouvez pas attachez cet engin a ce chauffeur."}),r(o)})})}function F({driverId:e}){return new Promise((n,t)=>{d.post(f.detachEngine,{driverId:e}).then(()=>n()).catch(r=>t(r))})}const G=()=>p(Q),J=()=>p(H),ne=()=>p(K),X=()=>p(F),oe=({driver:e})=>{const n=P(),t="detach-alert",{mutate:r,isLoading:o}=X(),i=()=>{o||r({driverId:e._id},{onSuccess(){n.invalidateQueries(["driverProfile",e._id])},onError(){u({message:"une erreur s'est produite."})}})};return s.jsxs("div",{children:[s.jsx("div",{onClick:()=>m(t,"open"),className:"text-red-500 cursor-pointer",children:s.jsx(W,{})}),s.jsx(v,{modalId:t,text:"êtes-vous sûr de vouloir détachez cet engin de ce chauffeur ?",onConfirm:i})]})},ie=({driver:e})=>{const n=P(),{isDriverActive:t,isDriverBlocked:r}=N(),o=`${e._id}-block-alert`,i=`${e._id}-unblock-alert`,{mutate:l,isLoading:O}=G(),{mutate:z,isLoading:E}=J(),D=()=>{O||E||l({driverId:e._id},{onSuccess(){n.invalidateQueries("drivers"),n.invalidateQueries(["driverProfile",e._id])},onError(){u({message:"une erreur s'est produite."})}})},I=()=>{O||E||z({driverId:e._id},{onSuccess(){n.invalidateQueries("drivers"),n.invalidateQueries(["driverProfile",e._id])},onError(){u({message:"une erreur s'est produite."})}})};return s.jsxs("div",{children:[s.jsxs("div",{className:"dropdown dropdown-bottom dropdown-left",children:[s.jsx("label",{tabIndex:0,className:"cursor-pointer",children:s.jsx($,{size:20})}),s.jsxs("ul",{tabIndex:0,className:"dropdown-content menu p-2 shadow-md bg-base-100 rounded-box w-60",children:[e.engineId&&s.jsx("li",{children:s.jsxs(_,{to:`/engines/details/${e.engineId}`,children:[s.jsx("span",{children:s.jsx(T,{size:18})}),s.jsx("span",{className:"first-letter:uppercase",children:"voir l'engin"})]})}),t(e)&&s.jsx("li",{children:s.jsxs("a",{onClick:()=>m(o,"open"),children:[s.jsx("span",{children:s.jsx(M,{size:18})}),s.jsx("span",{className:"first-letter:uppercase",children:"bloquer"})]})}),r(e)&&s.jsx("li",{children:s.jsxs("a",{onClick:()=>m(i,"open"),children:[s.jsx("span",{children:s.jsx(q,{size:18})}),s.jsx("span",{className:"first-letter:uppercase",children:"débloquer"})]})})]})]}),s.jsx(v,{modalId:o,text:"êtes-vous sûr de vouloir bloquer ce chauffeur ?",onConfirm:D}),s.jsx(v,{modalId:i,text:"êtes-vous sûr de vouloir débloquer ce chauffeur ?",onConfirm:I})]})},se=({status:e,className:n,...t})=>{const r={[h.ACTIVE]:{classNames:"bg-green-100 text-green-500"},[h.INACTIVE]:{classNames:"bg-orange-100 text-orange-500"},[h.BLOCKED]:{classNames:"bg-red-100 text-red-500"}};return s.jsx("div",{className:C("rounded-xl px-3 py-1 font-semibold inline-flex first-letter:uppercase",n,r[e].classNames),children:L(e)})};export{ie as D,se as a,oe as b,ne as u};
